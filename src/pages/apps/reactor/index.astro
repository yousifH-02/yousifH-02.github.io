---
const title = "Reactor";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Yousif Husni | {title}</title>
    <style>
      :root { --bg:#0b0f17; --card:#0f172a; --text:#e5e7eb; --muted:#9ca3af; --line: rgba(255,255,255,.10); }
      *{ box-sizing:border-box; }
      body{
        margin:0; font-family: ui-sans-serif, system-ui;
        background:
          radial-gradient(1200px 600px at 10% 0%, rgba(147,197,253,.12), transparent 60%),
          radial-gradient(900px 500px at 90% 10%, rgba(167,139,250,.10), transparent 55%),
          var(--bg);
        color: var(--text);
      }
      a{ color: inherit; text-decoration:none; }
      .wrap{ max-width: 980px; margin:0 auto; padding: 28px 18px 54px; }
      .top{ display:flex; justify-content:space-between; align-items:center; gap:12px; flex-wrap:wrap;
        border:1px solid var(--line); border-radius:16px; padding:12px 14px; background: rgba(17,24,39,.35); }
      .top h1{ margin:0; font-size:18px; }
      .home{ color:#93c5fd; font-size:13px; }
      .grid{ margin-top:12px; display:grid; grid-template-columns: 1.2fr .8fr; gap: 12px; }
      @media (max-width: 860px){ .grid{ grid-template-columns: 1fr; } }
      .card{ border:1px solid var(--line); border-radius:18px; padding:14px; background: rgba(15,23,42,.35); }
      .muted{ color: var(--muted); line-height: 1.55; }
      .arena{
        margin-top: 10px;
        height: 320px;
        border-radius: 18px;
        border: 1px solid var(--line);
        background: rgba(255,255,255,.03);
        display:grid;
        place-items:center;
        user-select:none;
        cursor:pointer;
        position:relative;
        overflow:hidden;
      }
      .arena.ready { background: rgba(255,255,255,.03); }
      .arena.wait { background: rgba(255,255,255,.03); }
      .arena.go { background: rgba(34,211,238,.18); border-color: rgba(34,211,238,.35); }
      .big{ font-size: 22px; margin:0; text-align:center; }
      .sub{ font-size: 13px; color: var(--muted); margin-top:8px; text-align:center; }
      .btnRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top: 12px; }
      .btn{
        padding: 10px 12px;
        border-radius: 14px;
        border: 1px solid rgba(255,255,255,.12);
        background: rgba(255,255,255,.04);
        font-size: 13px;
        display:inline-flex; align-items:center; gap:10px;
      }
      .btn:hover{ border-color: rgba(255,255,255,.22); }
      .stat{ display:flex; justify-content:space-between; gap:10px; margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--line); }
      code{ color: #93c5fd; }
    </style>
  </head>

  <body>
    <main class="wrap">
      <header class="top">
        <h1>{title}</h1>
        <a class="home" href="/apps/">‚Üê Apps</a>
      </header>

      <section class="grid">
        <div class="card">
          <div class="muted">
            Click to start. Wait for the panel to turn <code>GO</code>, then click as fast as you can.
            Your best time is saved on your device.
          </div>

          <div id="arena" class="arena ready" aria-label="Reaction game">
            <div>
              <p id="big" class="big">Click to Start</p>
              <div id="sub" class="sub">Tip: don‚Äôt click early üëÄ</div>
            </div>
          </div>

          <div class="btnRow">
            <button id="reset" class="btn" type="button">Reset best</button>
            <button id="share" class="btn" type="button">Copy result</button>
          </div>
        </div>

        <aside class="card">
          <h2 style="margin:0 0 8px; font-size:16px;">Stats</h2>
          <div class="muted" id="status">Not started.</div>

          <div class="stat">
            <span class="muted">Last</span>
            <strong id="last">‚Äî</strong>
          </div>
          <div class="stat">
            <span class="muted">Best</span>
            <strong id="best">‚Äî</strong>
          </div>
          <div class="stat">
            <span class="muted">Attempts</span>
            <strong id="attempts">0</strong>
          </div>
        </aside>
      </section>

      <script is:inline>
        const arena = document.getElementById("arena");
        const big = document.getElementById("big");
        const sub = document.getElementById("sub");
        const status = document.getElementById("status");
        const lastEl = document.getElementById("last");
        const bestEl = document.getElementById("best");
        const attemptsEl = document.getElementById("attempts");
        const resetBtn = document.getElementById("reset");
        const shareBtn = document.getElementById("share");

        const KEY_BEST = "yousif_reactor_best_ms";
        const KEY_ATT = "yousif_reactor_attempts";

        let state = "ready"; // ready | waiting | go
        let goAt = 0;
        let timer = null;

        const fmt = (ms) => ms === 0 ? "‚Äî" : ms + " ms";

        const getBest = () => Number(localStorage.getItem(KEY_BEST) || 0);
        const setBest = (v) => localStorage.setItem(KEY_BEST, String(v));
        const getAttempts = () => Number(localStorage.getItem(KEY_ATT) || 0);
        const setAttempts = (v) => localStorage.setItem(KEY_ATT, String(v));

        const sync = (last=0) => {
          const best = getBest();
          const attempts = getAttempts();
          lastEl.textContent = fmt(last);
          bestEl.textContent = fmt(best);
          attemptsEl.textContent = String(attempts);
        };

        const setUI = (next) => {
          state = next;
          arena.classList.remove("ready","wait","go");
          if (next === "ready") arena.classList.add("ready");
          if (next === "waiting") arena.classList.add("wait");
          if (next === "go") arena.classList.add("go");
        };

        const start = () => {
          if (timer) clearTimeout(timer);
          setUI("waiting");
          big.textContent = "Wait‚Ä¶";
          sub.textContent = "Clicking early = L üò≠";
          status.textContent = "Waiting for GO‚Ä¶";

          const delay = 900 + Math.floor(Math.random() * 2200); // 0.9s‚Äì3.1s
          timer = setTimeout(() => {
            setUI("go");
            big.textContent = "GO!";
            sub.textContent = "CLICK NOW";
            status.textContent = "GO ‚Äî click!";
            goAt = performance.now();
          }, delay);
        };

        const early = () => {
          if (timer) clearTimeout(timer);
          setUI("ready");
          big.textContent = "Too early üòÖ";
          sub.textContent = "Click to try again";
          status.textContent = "False start.";
        };

        const finish = () => {
          const rt = Math.max(1, Math.round(performance.now() - goAt));
          const attempts = getAttempts() + 1;
          setAttempts(attempts);

          const best = getBest();
          if (best === 0 || rt < best) setBest(rt);

          setUI("ready");
          big.textContent = rt + " ms";
          sub.textContent = "Click to play again";
          status.textContent = (getBest() === rt) ? "New personal best üéâ" : "Nice run.";

          sync(rt);
        };

        arena.addEventListener("click", () => {
          if (state === "ready") return start();
          if (state === "waiting") return early();
          if (state === "go") return finish();
        });

        resetBtn.addEventListener("click", () => {
          localStorage.removeItem(KEY_BEST);
          localStorage.removeItem(KEY_ATT);
          sync(0);
          status.textContent = "Stats reset.";
          big.textContent = "Click to Start";
          sub.textContent = "Tip: don‚Äôt click early üëÄ";
          setUI("ready");
        });

        shareBtn.addEventListener("click", async () => {
          const best = getBest();
          const text = best ? `My Reactor best: ${best} ms ‚ö°Ô∏è` : `I just played Reactor ‚ö°Ô∏è`;
          try {
            await navigator.clipboard.writeText(text);
            status.textContent = "Copied to clipboard.";
          } catch {
            status.textContent = "Couldn‚Äôt copy. (Browser blocked it.)";
          }
        });

        // init
        sync(0);
        setUI("ready");
      </script>
    </main>
  </body>
</html>